!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("lodash")):"function"==typeof define&&define.amd?define(["lodash"],t):e.ReduxStoreProvider=t(e._)}(this,function(a){"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=[],u={value:{}},h=a.merge({list:[],total:0},u);return function(){function t(e){if(void 0===e&&(e={}),-1<l.indexOf(this._key))throw new TypeError("Reducer: key '"+name+"' already exists");this._key=e.key,this._type=e.type,this._time=Date.now(),this._name=null,this._key||(this._key=this._time.toString(36).toUpperCase(),++this._time),this._action=null,this._handlers={},"list"===this._type?(this._reducer=this._reducerList.bind(this),this._initialState=t.getInitialStateList()):(this._reducer=this._reducerSingle.bind(this),this._initialState=t.getInitialState()),e.initialState&&this.setInitialState(e.initialState),l.push(this._key)}t.config=function(e){return e.initialState&&a.merge(u,e.initialState),e.initialStateList&&a.merge(h,e.initialStateList),this},t.getInitialState=function(){return a.cloneDeep(u)},t.getInitialStateList=function(){return a.merge(a.cloneDeep(h),u)};var e,i,n,r=t.prototype;return r.begin=function(e){if(e=String(e).toUpperCase(),this._handlers[e])throw new TypeError("Duplicate '"+e+"' exists on the begin method");return this._name=e,this},r.action=function(e){if(!this._name)throw new TypeError("Please call the function action before begin");if(!a.isFunction(e))throw new TypeError(s(e)+" is not a function");if(this._handlers[this._name]||(this._handlers[this._name]={}),this._handlers[this._name].action)throw new TypeError("Action: '"+this._name+"' already registered");return this._handlers[this._name].action=e.bind(null,this.type(this._name)),this},r.reducer=function(e){if(!this._name)throw new TypeError("Please call the function reducer before begin");if(!a.isFunction(e))throw new TypeError(s(e)+" is not a function");if(this._handlers[this._name]||(this._handlers[this._name]={}),this._handlers[this._name].reducer)throw new TypeError("Reducer: '"+this._name+"' already registered");return this._handlers[this._name].reducer=e.bind(null,this.type(this._name)),this},r.end=function(){return this._name=null,this},r.type=function(e){return void 0===e&&(e=this._name),this._key+"_"+String(e).toUpperCase()},r.setInitialState=function(e){return a.merge(this._initialState,e),this},r.getInitialState=function(){return this._initialState},r.getAction=function(){return this._action||("list"===this._type?this._action=this._actionList():this._action=this._actionSingle()),this._action},r.getReducer=function(){return this._reducer},r._reducerSingle=function(e,t){void 0===e&&(e=this._initialState);var i=this._key+"_";if(0!==t.type.indexOf(i))return e;var n=e;switch(t.type){case this.type("SET"):n=a.cloneDeep(e),a.set(n.value,t.path,t.value);break;case this.type("MERGE"):n=a.cloneDeep(e),a.merge(n.value,t.value);break;default:var r=t.type.substr(i.length);this._handlers[r]&&this._handlers[r].reducer&&(n=this._handlers[r].reducer(e,t))}return n},r._reducerList=function(e,t){var i,n,r;if(void 0===e&&(e=this._initialState),0!==t.type.indexOf(this._key+"_"))return e;var s=e;switch(t.type){case this.type("FILL"):(s=a.cloneDeep(e)).list=t.value,s.total=a.isNumber(+t.total)?t.total:t.value.length;break;case this.type("SHIFT"):(s=a.cloneDeep(e)).list.shift();break;case this.type("UNSHIFT"):(i=(s=a.cloneDeep(e)).list).unshift.apply(i,t.value);break;case this.type("POP"):(s=a.cloneDeep(e)).list.pop();break;case this.type("PUSH"):(n=(s=a.cloneDeep(e)).list).push.apply(n,t.value);break;case this.type("INSERT"):(r=(s=a.cloneDeep(e)).list).splice.apply(r,[t.index,0].concat(t.value));break;case this.type("REPLACE"):s=a.cloneDeep(e),a.isFunction(t.index)?s.list=s.list.map(t.index):s.list.splice(t.index,1,t.value);break;case this.type("REMOVE"):s=a.cloneDeep(e),a.isFunction(t.index)?s.list=s.list.filter(t.index):s.list.splice(t.index,1);break;default:s=this._reducerSingle(e,t)}return s},r._actionSingle=function(){var i=this._key,e={};for(var t in this._handlers)e[t.toLowerCase()]=this._handlers[t].action;return Object.assign({key:i,set:function(e,t){return{path:e,value:t,type:i+"_SET"}},merge:function(e){return{value:e,type:i+"_MERGE"}}},e)},r._actionList=function(){var r=this._key;return Object.assign({fill:function(e,t){return{total:t,value:e,type:r+"_FILL"}},shift:function(){return{type:r+"_SHIFT"}},unshift:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return{value:t,type:r+"_UNSHIFT"}},pop:function(){return{type:r+"_POP"}},push:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return{value:t,type:r+"_PUSH"}},insert:function(e){for(var t=arguments.length,i=new Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return{index:e,value:i,type:r+"_INSERT"}},replace:function(e,t){return{index:e,value:t,type:r+"_REPLACE"}},remove:function(e){return{index:e,type:r+"_REMOVE"}}},this._actionSingle())},e=t,(i=[{key:"key",get:function(){return this._key},set:function(e){throw new TypeError("set value not allowed for key")}}])&&o(e.prototype,i),n&&o(e,n),t}()});