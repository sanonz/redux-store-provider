!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("lodash")):"function"==typeof define&&define.amd?define(["lodash"],t):e.ReduxStoreProvider=t(e._)}(this,function(s){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=[],l={value:{}},c=s.merge({list:[],total:0},l);return function(){function t(e){if(void 0===e&&(e={}),-1<u.indexOf(this._key))throw new TypeError("Reducer: key '"+name+"' already exists");this._key=e.key,this._type=e.type,this._time=Date.now(),this._key||(this._key=this._time.toString(36).toUpperCase(),++this._time),this._handlers={},"list"===this._type?(this.reducer=this._reducerList.bind(this),this._initialState=t.getInitialStateList()):(this.reducer=this._reducer.bind(this),this._initialState=t.getInitialState()),e.initialState&&this.setInitialState(e.initialState),u.push(this._key)}t.config=function(e){return e.initialState&&s.merge(l,e.initialState),e.initialStateList&&s.merge(c,e.initialStateList),this},t.getInitialState=function(){return s.cloneDeep(l)},t.getInitialStateList=function(){return s.merge(s.cloneDeep(c),l)};var e,i,n,r=t.prototype;return r.addHandler=function(e,t){if(!s.isFunction(t))throw new TypeError(a(t)+" is not a function");if(this._handlers[e])throw new TypeError("Reducer: '"+e+"' already registered");return this._handlers[e]=t,this},r.type=function(e){return this._key+"_"+e},r.setInitialState=function(e){return s.merge(this._initialState,e),this},r.getInitialState=function(){return this._initialState},r.getReducer=function(){return this.reducer},r._reducer=function(e,t){void 0===e&&(e=this._initialState);var i=this._key+"_";if(0!==t.type.indexOf(i))return e;var n=e;switch(t.type){case this.type("SET"):n=s.cloneDeep(e),s.set(n.value,t.path,t.value);break;case this.type("MERGE"):n=s.cloneDeep(e),s.merge(n.value,t.value);break;default:var r=t.type.substr(i.length);this._handlers[r]&&(n=this._handlers[r](e,t))}return n},r._reducerList=function(e,t){var i,n,r;if(void 0===e&&(e=this._initialState),0!==t.type.indexOf(this._key+"_"))return e;var a=e;switch(t.type){case this.type("FILL"):(a=s.cloneDeep(e)).list=t.value,a.total=s.isNumber(+t.total)?t.total:t.value.length;break;case this.type("SHIFT"):(a=s.cloneDeep(e)).list.shift();break;case this.type("UNSHIFT"):(i=(a=s.cloneDeep(e)).list).unshift.apply(i,t.value);break;case this.type("POP"):(a=s.cloneDeep(e)).list.pop();break;case this.type("PUSH"):(n=(a=s.cloneDeep(e)).list).push.apply(n,t.value);break;case this.type("INSERT"):(r=(a=s.cloneDeep(e)).list).splice.apply(r,[t.index,0].concat(t.value));break;case this.type("REPLACE"):a=s.cloneDeep(e),s.isFunction(t.index)?a.list=a.list.map(t.index):a.list.splice(t.index,1,t.value);break;case this.type("REMOVE"):a=s.cloneDeep(e),s.isFunction(t.index)?a.list=a.list.filter(t.index):a.list.splice(t.index,1);break;default:a=this._reducer(e,t)}return a},r.createAction=function(e){void 0===e&&(e={});var i=this._key;return Object.assign({key:i,set:function(e,t){return{path:e,value:t,type:i+"_SET"}},merge:function(e){return{value:e,type:i+"_MERGE"}}},e)},r.createActionList=function(e){void 0===e&&(e={});var r=this._key;return Object.assign({fill:function(e,t){return{total:t,value:e,type:r+"_FILL"}},shift:function(){return{type:r+"_SHIFT"}},unshift:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return{value:t,type:r+"_UNSHIFT"}},pop:function(){return{type:r+"_POP"}},push:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return{value:t,type:r+"_PUSH"}},insert:function(e){for(var t=arguments.length,i=new Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return{index:e,value:i,type:r+"_INSERT"}},replace:function(e,t){return{index:e,value:t,type:r+"_REPLACE"}},remove:function(e){return{index:e,type:r+"_REMOVE"}}},this.createAction(e))},e=t,(i=[{key:"key",get:function(){return this._key},set:function(e){throw new TypeError("set value not allowed for key")}}])&&o(e.prototype,i),n&&o(e,n),t}()});